<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.5">
<title>Arquillian Algeron</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Arquillian Algeron</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_migration_from_arquillan_algeron_pact_1_x_to_2_x">1. Migration from Arquillan Algeron Pact 1.X to 2.X</a></li>
<li><a href="#_what_is_arquillian_algeron">2. What is Arquillian Algeron?</a></li>
<li><a href="#_consumer_driven_contracts">3. Consumer Driven Contracts</a></li>
<li><a href="#_pact">4. Pact</a>
<ul class="sectlevel2">
<li><a href="#_arquillian_algeron_pact">4.1. Arquillian Algeron Pact</a>
<ul class="sectlevel3">
<li><a href="#_how_pact_works">4.1.1. How Pact works?</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_arquillian_algeron_consumer">5. Arquillian Algeron Consumer</a>
<ul class="sectlevel2">
<li><a href="#_arquillian_algeron_pact_consumer">5.1. Arquillian Algeron Pact Consumer</a>
<ul class="sectlevel3">
<li><a href="#_pact_consumer_enrichers">5.1.1. Pact Consumer Enrichers</a></li>
<li><a href="#_pact_consumer_in_container">5.1.2. Pact Consumer In Container</a></li>
<li><a href="#_pact_consumer_standalone">5.1.3. Pact Consumer Standalone</a></li>
<li><a href="#_pact_consumer_configuration">5.1.4. Pact Consumer Configuration</a></li>
<li><a href="#JBoss_Forge_Arquillian_Algeron_Consumer_Addon">5.1.5. JBoss Forge Arquillian Addon</a></li>
</ul>
</li>
<li><a href="#_arquillian_algeron_consumer_publisher">5.2. Arquillian Algeron Consumer Publisher</a>
<ul class="sectlevel3">
<li><a href="#_folder_publisher">5.2.1. Folder Publisher</a></li>
<li><a href="#_url_publisher">5.2.2. URL Publisher</a></li>
<li><a href="#_pact_broker">5.2.3. Pact Broker</a></li>
<li><a href="#_git_publisher">5.2.4. Git Publisher</a></li>
<li><a href="#_spi">5.2.5. SPI</a></li>
<li><a href="#_jboss_forge_arquillian_addon">5.2.6. JBoss Forge Arquillian Addon</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_arquillian_algeron_provider">6. Arquillian Algeron Provider</a>
<ul class="sectlevel2">
<li><a href="#_retrievers">6.1. Retrievers</a>
<ul class="sectlevel3">
<li><a href="#_retrievers_as_annotation">6.1.1. Retrievers as Annotation</a></li>
<li><a href="#_retrievers_as_configuration">6.1.2. Retrievers as Configuration</a></li>
<li><a href="#_jboss_forge_arquillian_addon_2">6.1.3. JBoss Forge Arquillian Addon</a></li>
</ul>
</li>
<li><a href="#_arquillian_algeron_pact_provider">6.2. Arquillian Algeron Pact Provider</a>
<ul class="sectlevel3">
<li><a href="#_pact_provider_in_container">6.2.1. Pact Provider In Container</a></li>
<li><a href="#_pact_provider_standalone">6.2.2. Pact Provider Standalone</a></li>
<li><a href="#_pact_provider_enrichers">6.2.3. Pact Provider Enrichers</a></li>
<li><a href="#_pact_provider_configuration">6.2.4. Pact Provider Configuration</a></li>
<li><a href="#_pact_states">6.2.5. Pact States</a></li>
<li><a href="#_assertj_integration">6.2.6. AssertJ integration</a></li>
<li><a href="#_arquillian_recorder_reporter_integration">6.2.7. Arquillian Recorder Reporter integration</a></li>
<li><a href="#JBoss_Forge_Arquillian_Algeron_Provider_Addon">6.2.8. JBoss Forge Arquillian Addon</a></li>
</ul>
</li>
<li><a href="#_skipping_deployment">6.3. Skipping Deployment</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><span class="image"><a class="image" href="https://travis-ci.org/arquillian/arquillian-algeron"><img src="https://travis-ci.org/arquillian/arquillian-algeron.svg?branch=master" alt="Build Status"></a></span></p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Using Arquillian Algeron Pact Provider requires at least Arquillian Core 1.1.12.Final or above.
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Arquillian Algeron Pact 1.X works with versions of Pact previous to 3.5.0. Arquillian Algeron Pact 2.X works with Pact 3.5.0.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_migration_from_arquillan_algeron_pact_1_x_to_2_x"><a class="anchor" href="#_migration_from_arquillan_algeron_pact_1_x_to_2_x"></a>1. Migration from Arquillan Algeron Pact 1.X to 2.X</h2>
<div class="sectionbody">
<div class="paragraph">
<p>With the release of Pact 3.5.0, <code>toFragment</code> method has been deprecated in favor of <code>toPact()</code>.
Also this method instead of returning <code>PactFragment</code> now returns <code>RequestResponsePact</code>.</p>
</div>
<div class="paragraph">
<p>Because of this change your contract definition should be adapted accordingly:</p>
</div>
<div class="listingblock">
<div class="title">Algeron Pact 1.X</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Pact</span>(provider = <span class="string"><span class="delimiter">&quot;</span><span class="content">test_provider</span><span class="delimiter">&quot;</span></span>, consumer = <span class="string"><span class="delimiter">&quot;</span><span class="content">test_consumer</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> PactFragment createFragment(PactDslWithProvider builder) {

    <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; header = <span class="keyword">new</span> <span class="predefined-type">HashMap</span>&lt;&gt;();
    header.put(<span class="string"><span class="delimiter">&quot;</span><span class="content">Content-Type</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">application/json</span><span class="delimiter">&quot;</span></span>);

    <span class="keyword">return</span> builder
        .given(<span class="string"><span class="delimiter">&quot;</span><span class="content">test state</span><span class="delimiter">&quot;</span></span>)
        .uponReceiving(<span class="string"><span class="delimiter">&quot;</span><span class="content">ConsumerTest test interaction</span><span class="delimiter">&quot;</span></span>)
        .path(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>)
        .method(<span class="string"><span class="delimiter">&quot;</span><span class="content">GET</span><span class="delimiter">&quot;</span></span>)
        .willRespondWith()
        .status(<span class="integer">200</span>)
        .headers(header)
        .bodyWithSingleQuotes((<span class="string"><span class="delimiter">&quot;</span><span class="content">{'responsetest': true, 'name': 'harry'}</span><span class="delimiter">&quot;</span></span>))
        .toFragment();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>to:</p>
</div>
<div class="listingblock">
<div class="title">Algeron Pact 2.X</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Pact</span>(provider = <span class="string"><span class="delimiter">&quot;</span><span class="content">test_provider</span><span class="delimiter">&quot;</span></span>, consumer = <span class="string"><span class="delimiter">&quot;</span><span class="content">test_consumer</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> RequestResponsePact createFragment(PactDslWithProvider builder) {

    <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; header = <span class="keyword">new</span> <span class="predefined-type">HashMap</span>&lt;&gt;();
    header.put(<span class="string"><span class="delimiter">&quot;</span><span class="content">Content-Type</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">application/json</span><span class="delimiter">&quot;</span></span>);

    <span class="keyword">return</span> builder
        .given(<span class="string"><span class="delimiter">&quot;</span><span class="content">test state</span><span class="delimiter">&quot;</span></span>)
        .uponReceiving(<span class="string"><span class="delimiter">&quot;</span><span class="content">ConsumerTest test interaction</span><span class="delimiter">&quot;</span></span>)
        .path(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>)
        .method(<span class="string"><span class="delimiter">&quot;</span><span class="content">GET</span><span class="delimiter">&quot;</span></span>)
        .willRespondWith()
        .status(<span class="integer">200</span>)
        .headers(header)
        .bodyWithSingleQuotes((<span class="string"><span class="delimiter">&quot;</span><span class="content">{'responsetest': true, 'name': 'harry'}</span><span class="delimiter">&quot;</span></span>))
        .toPact();
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_what_is_arquillian_algeron"><a class="anchor" href="#_what_is_arquillian_algeron"></a>2. What is Arquillian Algeron?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In microservices architecture you typically have one or more services that make remote calls to one or more services to get information from them.</p>
</div>
<div class="paragraph">
<p>For example you might have one service called <em>BeerService</em> that returns information of a beer.
But this service needs to call another service <em>CommentsService</em> which returns the comments that users has done for given beer.
After <em>BeerService</em> receives all the comments for that beer, everything is packed and sent to the client.</p>
</div>
<div class="paragraph">
<p>So as you can see there is a communication between both services where one needs to know what and how to send data such as name of fields, type of data or status code (<em>CommentsService</em>) and another one that needs to know how to interpret what is received (<em>BeerService</em>).</p>
</div>
<div class="paragraph">
<p>It seems obvious that it must exist some kind of agreement between them so they can understand each other correctly in all of their communications.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_consumer_driven_contracts"><a class="anchor" href="#_consumer_driven_contracts"></a>3. Consumer Driven Contracts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A <strong>Contract</strong> is a collection of agreements between a client ( or Consumer which in previous example is <em>BeerService</em>) and an API (or Provider which in previous example is <em>CommentsService</em>) that describes the interactions that can take place between them.</p>
</div>
<div class="paragraph">
<p>In summary <strong>Consumer Driven Contracts</strong> is a pattern that drives the development of the Provider from its Consumers point of view.
This means that consumer describes what and how he wants to receive the information, describing in form of contract and then provider implements its service following that contract.
When the client validates that can consume what it is been defined in the contract and provider validates that what he produces meets the contract, then you can be sure that contract expectations are met and they will be able to communicate each other.</p>
</div>
<div class="paragraph">
<p>Also notice that thanks of these tests, if anyone changes the client or the server side to not meet the contract, you&#8217;ll detect before it is deployed to production.</p>
</div>
<div class="paragraph">
<p>You can read more about Consumer-Driven contracts <a href="http://martinfowler.com/articles/consumerDrivenContracts.html">here</a> or at book <a href="https://www.manning.com/books/testing-java-microservices">Testing Java Microservices</a> chapter 6.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_pact"><a class="anchor" href="#_pact"></a>4. Pact</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_arquillian_algeron_pact"><a class="anchor" href="#_arquillian_algeron_pact"></a>4.1. Arquillian Algeron Pact</h3>
<div class="paragraph">
<p>Currently Arquillian Algeron only supports one format of contracts (Pact).
But we have plans to extend it to other formats like <em>swagger</em>.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/DiUS/pact-jvm">Pact-JVM</a> is an implementation for JVM languages of Pact.</p>
</div>
<div class="paragraph">
<p>Arquillian Algeron Pact is the integration of all Arquillian philosophy/extensions into Consumer Driven Contracts approach using Pact-JVM.</p>
</div>
<div class="paragraph">
<p><a href="https://docs.pact.io/">Pact</a> is a framework that provides support for Consumer Driven Contracts testing.
Pact is implemented in several languages such as Ruby, JVM, .NET, JavaScript, Go and Swift.</p>
</div>
<div class="sect3">
<h4 id="_how_pact_works"><a class="anchor" href="#_how_pact_works"></a>4.1.1. How Pact works?</h4>
<div class="paragraph">
<p>Obviously any Contract test is composed by two faces, one for the consumer and another one for the provider and a contract file that is sent from consumer to provider.
Let&#8217;s see the steps to write contract tests using Pact.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Consumer expectations are set up on a mock server.
In this way consumer doesn&#8217;t need to know how to deploy a provider (since it might not be trivial to do it, and probably at the end you&#8217;ll end up writing end-to-end tests instead of contract tests).
So consumer tests its client/gateway code to communicate against a mock server.</p>
</li>
<li>
<p>When consumer tests are run, mocked requests and responses are written into a "pact" file, which in fact it is the contract that has been defined in consumer part.</p>
</li>
<li>
<p>The "pact" file are sent to provider project to be replayed against the provider service.
Then real responses from provider are checked against the expected responses defined in contract.</p>
</li>
<li>
<p>If consumer is able to produce a "pact" file and provider meets all the expectations, then you can say that contract is verified by both parties and will be able to communicate.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>These steps can be summarized in next diagram:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="http://www.pact.io/media/pact_two_parts.png" alt="pact two parts">
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_arquillian_algeron_consumer"><a class="anchor" href="#_arquillian_algeron_consumer"></a>5. Arquillian Algeron Consumer</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_arquillian_algeron_pact_consumer"><a class="anchor" href="#_arquillian_algeron_pact_consumer"></a>5.1. Arquillian Algeron Pact Consumer</h3>
<div class="paragraph">
<p>First thing to do is develop the <strong>Consumer</strong> part of the test.
Consumer part of Consumer-Driven Contract defines requirements from the consumer of the API which are then used to develop the client interaction with the API as well as to validate provider implementation.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Arquillian Algeron Pact 1.X works with versions of Pact previous to 3.5.0. Arquillian Algeron Pact 2.X works with Pact 3.5.0.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_pact_consumer_enrichers"><a class="anchor" href="#_pact_consumer_enrichers"></a>5.1.1. Pact Consumer Enrichers</h4>
<div class="paragraph">
<p>You can use in a test <code>@StubServer</code> annotation to inject URL where stub http server is started.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@RunWith</span>(Arquillian.class)
<span class="annotation">@Pact</span>(provider=<span class="string"><span class="delimiter">&quot;</span><span class="content">test_provider</span><span class="delimiter">&quot;</span></span>, consumer=<span class="string"><span class="delimiter">&quot;</span><span class="content">test_consumer</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyTest</span> {

  <span class="annotation">@StubServer</span>
  <span class="predefined-type">URL</span> url;

}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_pact_consumer_in_container"><a class="anchor" href="#_pact_consumer_in_container"></a>5.1.2. Pact Consumer In Container</h4>
<div class="paragraph">
<p>Arquillian has two modes of working <strong>In Container</strong> (which means having a <code>@Deployment</code> method) and Arquillian takes care of managing lifecycle of the server and deploy the archive, or <strong>Standalone</strong> (no <code>@Deployment</code> method) where Arquillian assumes that everything is already deployed.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s see how to write the consumer part in In Container mode.</p>
</div>
<div class="paragraph">
<p>First thing to do is add typical Arquillian dependencies such as Arquillian bom and the dependency of the container you want to use.
Nothing new here:</p>
</div>
<div id="arqdeps" class="listingblock">
<div class="title">pom.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependencyManagement&gt;</span>
    <span class="tag">&lt;dependencies&gt;</span>
        <span class="tag">&lt;dependency&gt;</span>
            <span class="tag">&lt;groupId&gt;</span>org.jboss.arquillian<span class="tag">&lt;/groupId&gt;</span>
            <span class="tag">&lt;artifactId&gt;</span>arquillian-bom<span class="tag">&lt;/artifactId&gt;</span>
            <span class="tag">&lt;version&gt;</span>${version.arquillian_core}<span class="tag">&lt;/version&gt;</span>
            <span class="tag">&lt;type&gt;</span>pom<span class="tag">&lt;/type&gt;</span>
            <span class="tag">&lt;scope&gt;</span>import<span class="tag">&lt;/scope&gt;</span>
        <span class="tag">&lt;/dependency&gt;</span>
    <span class="tag">&lt;/dependencies&gt;</span>
<span class="tag">&lt;/dependencyManagement&gt;</span>

<span class="tag">&lt;dependencies&gt;</span>
    <span class="tag">&lt;dependency&gt;</span>
        <span class="tag">&lt;groupId&gt;</span>org.jboss.arquillian.junit<span class="tag">&lt;/groupId&gt;</span>
        <span class="tag">&lt;artifactId&gt;</span>arquillian-junit-container<span class="tag">&lt;/artifactId&gt;</span>
        <span class="tag">&lt;scope&gt;</span>test<span class="tag">&lt;/scope&gt;</span>
    <span class="tag">&lt;/dependency&gt;</span>
    <span class="tag">&lt;dependency&gt;</span>
        <span class="tag">&lt;groupId&gt;</span>org.arquillian.container<span class="tag">&lt;/groupId&gt;</span>
        <span class="tag">&lt;artifactId&gt;</span>arquillian-container-chameleon<span class="tag">&lt;/artifactId&gt;</span> <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="tag">&lt;version&gt;</span>1.0.0.Alpha7<span class="tag">&lt;/version&gt;</span>
        <span class="tag">&lt;scope&gt;</span>test<span class="tag">&lt;/scope&gt;</span>
    <span class="tag">&lt;/dependency&gt;</span>
<span class="tag">&lt;/dependencies&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Notice that I am using Chameleon generic container, you can read more <a href="http://www.lordofthejars.com/2016/09/arquillian-chameleon-for-sake-of.html">here</a>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Then you need to add <code>arquillian-pact-consumer</code> dependency as well as <code>pact-jvm-consumer</code> dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependencies&gt;</span>
    <span class="tag">&lt;dependency&gt;</span>
        <span class="tag">&lt;groupId&gt;</span>org.arquillian.algeron<span class="tag">&lt;/groupId&gt;</span>
        <span class="tag">&lt;artifactId&gt;</span>arquillian-algeron-pact-consumer-core<span class="tag">&lt;/artifactId&gt;</span>
        <span class="tag">&lt;version&gt;</span>${version.arquillian_algeron}<span class="tag">&lt;/version&gt;</span>
        <span class="tag">&lt;scope&gt;</span>test<span class="tag">&lt;/scope&gt;</span>
    <span class="tag">&lt;/dependency&gt;</span>
    <span class="tag">&lt;dependency&gt;</span>
        <span class="tag">&lt;groupId&gt;</span>au.com.dius<span class="tag">&lt;/groupId&gt;</span>
        <span class="tag">&lt;artifactId&gt;</span>pact-jvm-consumer_2.11<span class="tag">&lt;/artifactId&gt;</span>
        <span class="tag">&lt;scope&gt;</span>test<span class="tag">&lt;/scope&gt;</span>
        <span class="tag">&lt;version&gt;</span>3.5.0<span class="tag">&lt;/version&gt;</span> <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="tag">&lt;/dependency&gt;</span>
<span class="tag">&lt;/dependencies&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Arquillian Algeron Pact 2.X only works with 3.5.0, Arquillian Algeron Pact 1.X works with &lt; 3.5.0.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After dependencies you can write the test that defines the contract:</p>
</div>
<div id="incontainer" class="listingblock">
<div class="title">ClientGatewayTest.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@RunWith</span>(Arquillian.class) <i class="conum" data-value="1"></i><b>(1)</b>
<span class="annotation">@Pact</span>(provider=<span class="string"><span class="delimiter">&quot;</span><span class="content">test_provider</span><span class="delimiter">&quot;</span></span>, consumer=<span class="string"><span class="delimiter">&quot;</span><span class="content">test_consumer</span><span class="delimiter">&quot;</span></span>) <i class="conum" data-value="2"></i><b>(2)</b>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ClientGatewayTest</span> {

    <span class="annotation">@Deployment</span> <i class="conum" data-value="3"></i><b>(3)</b>
    <span class="directive">public</span> <span class="directive">static</span> JavaArchive createDeployment() {
        <span class="keyword">return</span> ShrinkWrap.create(JavaArchive.class).addClasses(ClientGateway.class);
    }

    <span class="directive">public</span> RequestResponsePact createFragment(PactDslWithProvider builder) {

        <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; header = <span class="keyword">new</span> <span class="predefined-type">HashMap</span>&lt;&gt;();
        header.put(<span class="string"><span class="delimiter">&quot;</span><span class="content">Content-Type</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">application/json</span><span class="delimiter">&quot;</span></span>);

        <span class="keyword">return</span> builder
                .given(<span class="string"><span class="delimiter">&quot;</span><span class="content">test state</span><span class="delimiter">&quot;</span></span>)
                .uponReceiving(<span class="string"><span class="delimiter">&quot;</span><span class="content">ConsumerTest test interaction</span><span class="delimiter">&quot;</span></span>)
                .path(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>)
                .method(<span class="string"><span class="delimiter">&quot;</span><span class="content">GET</span><span class="delimiter">&quot;</span></span>)
                .willRespondWith()
                .status(<span class="integer">200</span>)
                .headers(header)
                .body(<span class="string"><span class="delimiter">&quot;</span><span class="content">{</span><span class="char">\&quot;</span><span class="content">responsetest</span><span class="char">\&quot;</span><span class="content">: true, </span><span class="char">\&quot;</span><span class="content">name</span><span class="char">\&quot;</span><span class="content">: </span><span class="char">\&quot;</span><span class="content">harry</span><span class="char">\&quot;</span><span class="content">}</span><span class="delimiter">&quot;</span></span>)
                .toPact(); <i class="conum" data-value="4"></i><b>(4)</b>
    }

    <span class="annotation">@Inject</span> <i class="conum" data-value="5"></i><b>(5)</b>
    ClientGateway clientGateway;

    <span class="annotation">@StubServer</span> <i class="conum" data-value="6"></i><b>(6)</b>
    <span class="predefined-type">URL</span> url;

    <span class="annotation">@Test</span>
    <span class="annotation">@PactVerification</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">test_provider</span><span class="delimiter">&quot;</span></span>) <i class="conum" data-value="7"></i><b>(7)</b>
    <span class="directive">public</span> <span class="type">void</span> should_return_message() <span class="directive">throws</span> <span class="exception">IOException</span> {
        assertThat(clientGateway.getMessage(url), is(<span class="string"><span class="delimiter">&quot;</span><span class="content">{</span><span class="char">\&quot;</span><span class="content">responsetest</span><span class="char">\&quot;</span><span class="content">: true, </span><span class="char">\&quot;</span><span class="content">name</span><span class="char">\&quot;</span><span class="content">: </span><span class="char">\&quot;</span><span class="content">harry</span><span class="char">\&quot;</span><span class="content">}</span><span class="delimiter">&quot;</span></span>)); <i class="conum" data-value="8"></i><b>(8)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Arquillian Runner</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>To define the contract you need to configure expectations of mock server. This is done by annotating a method or class with <code>@Pact</code> annotation and setting the provider and consumer name</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Defines what you want to deploy to defined container. In this case an EJB that acts as gateway to another service</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>A Pact method returns a fragment of the contract which might be the complete contract or not</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Typical Arquillian enrichment</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td><code>@StubServer</code> annotation is used for enrich test with stub http server Url.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Defines which provider is validated when this test method is executed.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>Asserts that the gateway can read the kind of messages sent by provider. Notice that now it is pretty simple, but in real test you&#8217;ll test for example that message is correctly bound to an object.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After this test is executed, contract is placed at <code>target/pacts</code> directory or <code>build/pacts</code> in case of using Gradle.
Then you can send contract to provider side.</p>
</div>
<div class="paragraph">
<p>Notice that contract and/or mock responses are defined using Pact DSL.
You can read more about this DSL at <a href="https://github.com/DiUS/pact-jvm/tree/master/pact-jvm-consumer-junit#using-the-pact-dsl-directly">Using the Pact DSL directly</a>.</p>
</div>
<div class="paragraph">
<p>Important things to retain from consumer part:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It is an Arquillian test so you can use anything that Arquillian provides.</p>
</li>
<li>
<p>Methods or classes annotated with <code>@Pact</code> defines a fragment of the contract that at same time is used by mock server for providing responses.</p>
</li>
<li>
<p>In case of using several methods annotated with <code>@Pact</code> annotation, you need to use <code>fragment</code> attribute <code>@PactVerification(.. fragment="methodName")`to set which fragment is under test for each `@Test</code> method.</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can use <code>@Pact</code> annotation at class level, so methods that defines a pact fragment, just need to return <code>PactFragment</code> class. Information will be picked from class level. In case of setting annotation at class and method level too, the one defined on the method will take precedence.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can see the full example at: <a href="https://github.com/arquillian/arquillian-algeron/tree/master/pact/consumer/ftest-container">ftest-incontainer</a></p>
</div>
</div>
<div class="sect3">
<h4 id="_pact_consumer_standalone"><a class="anchor" href="#_pact_consumer_standalone"></a>5.1.3. Pact Consumer Standalone</h4>
<div class="paragraph">
<p><strong>Standalone</strong> mode (no <code>@Deployment</code> method), Arquillian assumes that everything is already deployed.</p>
</div>
<div class="paragraph">
<p>The only difference between previous example is that you only need <code>arquillian-junit-standalone</code> instead of <code>arquilian-junit-container</code> and don&#8217;t need to define any container adapter.
Obviously no <code>@Deployment</code> method is required:</p>
</div>
<div class="listingblock">
<div class="title">ConsumerTest.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@RunWith</span>(Arquillian.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">ConsumerTest</span> {

    <span class="annotation">@Pact</span>(provider = <span class="string"><span class="delimiter">&quot;</span><span class="content">test_provider</span><span class="delimiter">&quot;</span></span>, consumer = <span class="string"><span class="delimiter">&quot;</span><span class="content">test_consumer</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> RequestResponsePact createFragment(PactDslWithProvider builder) {

        <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; header = <span class="keyword">new</span> <span class="predefined-type">HashMap</span>&lt;&gt;();
        header.put(<span class="string"><span class="delimiter">&quot;</span><span class="content">Content-Type</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">application/json</span><span class="delimiter">&quot;</span></span>);

        <span class="keyword">return</span> builder
                .given(<span class="string"><span class="delimiter">&quot;</span><span class="content">test state</span><span class="delimiter">&quot;</span></span>)
                .uponReceiving(<span class="string"><span class="delimiter">&quot;</span><span class="content">ConsumerTest test interaction</span><span class="delimiter">&quot;</span></span>)
                .path(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>)
                .method(<span class="string"><span class="delimiter">&quot;</span><span class="content">GET</span><span class="delimiter">&quot;</span></span>)
                .willRespondWith()
                .status(<span class="integer">200</span>)
                .headers(header)
                .body(<span class="string"><span class="delimiter">&quot;</span><span class="content">{</span><span class="char">\&quot;</span><span class="content">responsetest</span><span class="char">\&quot;</span><span class="content">: true, </span><span class="char">\&quot;</span><span class="content">name</span><span class="char">\&quot;</span><span class="content">: </span><span class="char">\&quot;</span><span class="content">harry</span><span class="char">\&quot;</span><span class="content">}</span><span class="delimiter">&quot;</span></span>)
                .toPact();
    }

    <span class="annotation">@StubServer</span>
    <span class="predefined-type">URL</span> url;

    <span class="annotation">@Test</span>
    <span class="annotation">@PactVerification</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">test_provider</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="type">void</span> runTest() <span class="directive">throws</span> <span class="exception">IOException</span> {
        <span class="keyword">new</span> ConsumerClient().get(url).body(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, equalTo(<span class="string"><span class="delimiter">&quot;</span><span class="content">harry</span><span class="delimiter">&quot;</span></span>));
        assertThat(<span class="keyword">new</span> <span class="predefined-type">File</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">target/pacts/test_consumer-test_provider.json</span><span class="delimiter">&quot;</span></span>)).exists();
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Code is pretty similar as <a href="#incontainer">previous test</a> but now the consumer client/gateway object is instantiated as plain java object instead of container managed.</p>
</div>
<div class="paragraph">
<p>You can see the full example at: <a href="https://github.com/arquillian/arquillian-algeron/tree/master/pact/consumer/ftest">ftest</a></p>
</div>
</div>
<div class="sect3">
<h4 id="_pact_consumer_configuration"><a class="anchor" href="#_pact_consumer_configuration"></a>5.1.4. Pact Consumer Configuration</h4>
<div class="paragraph">
<p>Arquillian Algeron Pact Consumer can be configured using Arquillian configuration mechanism (<code>arquillian.xml</code> file or system properties).</p>
</div>
<div class="listingblock">
<div class="title">arquillian.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="tag">&lt;arquillian</span> <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://jboss.org/schema/arquillian</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://jboss.org/schema/arquillian</span>
    <span class="content">http://jboss.org/schema/arquillian/arquillian_1_0.xsd</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>

    <span class="tag">&lt;extension</span> <span class="attribute-name">qualifier</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pact-consumer</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pactSpecVersion</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>1<span class="tag">&lt;/property&gt;</span>
    <span class="tag">&lt;/extension&gt;</span>

<span class="tag">&lt;/arquillian&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The attributes are:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bind host for mock server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">localhost</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Listening port for mock server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9090</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pactSpecVesion</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pact specification version as integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">https</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If mock server should start using https instead of http</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">provider</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If you want to set provider globally</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pactArtifactVersion</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">By default Arquillian Algeron Pact packages pact dependencies in container tests. To get the version of artifacts to package, checks the current pact version of classpath.
 If you want to use another one rather the one defined in your classpath, you can set it here the version.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pactReportDir</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Directory where contracts are stored.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">target/pacts</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="JBoss_Forge_Arquillian_Algeron_Consumer_Addon"><a class="anchor" href="#JBoss_Forge_Arquillian_Algeron_Consumer_Addon"></a>5.1.5. JBoss Forge Arquillian Addon</h4>
<div class="paragraph">
<p><a href="http://forge.jboss.org">Forge</a> Arquillian Addon offers an integration with Arquillian Algeron Consumer.</p>
</div>
<div class="paragraph">
<p>To use it apart from having the Forge Arquillian Addon installed in Forge, you need to have arquillian dependencies registered on build tool.</p>
</div>
<div class="paragraph">
<p>To register Arquillian Consumer dependencies in build tool just run next command:</p>
</div>
<div class="paragraph">
<p><code>arquillian-algeron-setup-consumer --contracts-library pact</code></p>
</div>
<div class="paragraph">
<p>After that you can enrich a given Arquillian test with consumer annotations and contract scaffolding with next command:</p>
</div>
<div class="paragraph">
<p><code>arquillian-algeron-create-contract-fragment --consumer myconsumer --provider myprovider --fragment myFragment --test-class org.superbiz.MyContractTest</code></p>
</div>
<div class="paragraph">
<p>It is important to note that test class should be already created (for example using <code>arquillian-create-test --named MyContractTest --target-package org.superbiz</code> command).</p>
</div>
<div class="paragraph">
<p>See it alive in next terminal cast:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="https://asciinema.org/a/104383"><img src="https://asciinema.org/a/104383.png" alt="104383"></a>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_arquillian_algeron_consumer_publisher"><a class="anchor" href="#_arquillian_algeron_consumer_publisher"></a>5.2. Arquillian Algeron Consumer Publisher</h3>
<div class="paragraph">
<p>Arquillian Algeron also offers additional ways to of publishing contracts files comparing to what Pact itself is providing.</p>
</div>
<div class="paragraph">
<p>In Arquillian Algeron we have defined a Pact Publishing SPI so you can implement your own publisher.
We currently support three different publishers - Folder, URL[POST method] and Git.</p>
</div>
<div class="paragraph">
<p>It is important to note that by default <code>publishContracts</code> configuration attribute is <code>false</code>.
This means that when you run any consumer contract test, contracts are not published.
<code>publishContracts</code> configuration attribute should be only set to `true`if and only if you are publishing a new version of a consumer, and this will be done by your CI/CD environment.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Arquillian can be configured using system properties or environment variables.
If you want to enable pact publishing feature only in CI/CD, you can set environment variable <code>arq.extension.algeron-consumer.publishContracts</code> to true.
Also you can use the form <code>&lt;property name="publishContracts"&gt;${env.publishcontracts:false}&lt;/property&gt;</code> and setting <code>publishContracts</code> environment variable with correct value.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_folder_publisher"><a class="anchor" href="#_folder_publisher"></a>5.2.1. Folder Publisher</h4>
<div class="paragraph">
<p>Folder publisher copies "pact" files from configured output directory (by default <code>target/pacts</code>) to another directory.
To configure folder publisher you need to configure <code>pactPublishConfiguration</code> with next configuration:</p>
</div>
<div class="listingblock">
<div class="title">arquillian.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="tag">&lt;arquillian</span> <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://jboss.org/schema/arquillian</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://jboss.org/schema/arquillian</span>
    <span class="content">http://jboss.org/schema/arquillian/arquillian_1_0.xsd</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>

    <span class="tag">&lt;extension</span> <span class="attribute-name">qualifier</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">algeron-consumer</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">publishConfiguration</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            provider: folder <i class="conum" data-value="1"></i><b>(1)</b>
            outputFolder: /mypacts <i class="conum" data-value="2"></i><b>(2)</b>
            contractsFolder: target/pacts <i class="conum" data-value="3"></i><b>(3)</b>
            deleteFolder: true <i class="conum" data-value="4"></i><b>(4)</b>
        <span class="tag">&lt;/property&gt;</span>
    <span class="tag">&lt;/extension&gt;</span>

<span class="tag">&lt;/arquillian&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>provider</code> attribute is used for setting which publisher to use. In case of Folder publisher, you need to set to <code>folder</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>outputFolder</code> configures where to copy contract files.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>contractsFolder</code> configures folder where contract files are generated by the engine.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Delete output folder before publishing results. By default its value is <code>false</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can set <code>outputFolder</code> value using Java system property <code>${name:defaultvalue} or environment variable `${env.name:defaultvalue}.
For example `outputFolder: ${output:/mypacts}</code> will first check if there is a Java system property with name output and get the value.
If that is not defined it will use the default value i.e. <code>/mypacts</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_url_publisher"><a class="anchor" href="#_url_publisher"></a>5.2.2. URL Publisher</h4>
<div class="paragraph">
<p>URL publisher sends a <code>POST</code> request to configured URL, appending at the end of the URL the "pact" filename and sending the contract content as body content.
For example given <code><a href="http://myhost/pacts" class="bare">http://myhost/pacts</a></code> and a "contract" file called <code>consumer_provider.json</code>, the resulting URL would be: <code><a href="http://myhost/pacts/consumer_provider.json" class="bare">http://myhost/pacts/consumer_provider.json</a></code></p>
</div>
<div class="listingblock">
<div class="title">arquillian.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="tag">&lt;arquillian</span> <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://jboss.org/schema/arquillian</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://jboss.org/schema/arquillian</span>
    <span class="content">http://jboss.org/schema/arquillian/arquillian_1_0.xsd</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>

    <span class="tag">&lt;extension</span> <span class="attribute-name">qualifier</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">algeron-consumer</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">publishConfiguration</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            provider: url <i class="conum" data-value="1"></i><b>(1)</b>
            url: http://localhost:8081/pacts <i class="conum" data-value="2"></i><b>(2)</b>
            contractsFolder: target/pacts <i class="conum" data-value="3"></i><b>(3)</b>
        <span class="tag">&lt;/property&gt;</span>
    <span class="tag">&lt;/extension&gt;</span>

<span class="tag">&lt;/arquillian&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>provider</code> attribute is used for setting which publisher to use. In case of URL publisher, you need to set to <code>url</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>url</code> configures to send as <code>POST</code> the contract content.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>contractsFolder</code> configures folder where contract files are generated by the engine.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can set <code>url</code> value using Java system property <code>${name:defaultvalue}</code> or environment variable <code>${env.name:defaultvalue}</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_pact_broker"><a class="anchor" href="#_pact_broker"></a>5.2.3. Pact Broker</h4>
<div class="paragraph">
<p>You can publish contracts to Pact Broker server.</p>
</div>
<div class="listingblock">
<div class="title">arquillian.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;extension</span> <span class="attribute-name">qualifier</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">algeron-provider</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">retrieverConfiguration</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
          provider: pactbroker
          url: <span class="tag">&lt;url</span> <span class="attribute-name">of</span> <span class="attribute-name">pact</span> <span class="attribute-name">broker</span> <span class="attribute-name">server</span><span class="tag">&gt;</span>
          username: <span class="tag">&lt;username</span> <span class="attribute-name">to</span> <span class="attribute-name">access</span><span class="tag">&gt;</span>
          password: <span class="tag">&lt;password</span> <span class="attribute-name">to</span> <span class="attribute-name">access</span><span class="tag">&gt;</span>
          contractsFolder: <span class="tag">&lt;path</span> <span class="attribute-name">where</span> <span class="attribute-name">pact</span> <span class="attribute-name">files</span> <span class="attribute-name">are</span> <span class="attribute-name">generated</span><span class="tag">&gt;</span>
          version: <span class="tag">&lt;version</span> <span class="attribute-name">which</span> <span class="attribute-name">pacts</span> <span class="attribute-name">are</span> <span class="attribute-name">stored</span><span class="tag">&gt;</span>
  <span class="tag">&lt;/property&gt;</span>
<span class="tag">&lt;/extension&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Also you need to add <code>org.arquillian.algeron:arquillian-algeron-consumer-pact-broker-publisher:${version}</code> dependency. This is only supported in case of using Pact provider.</p>
</div>
<div class="paragraph">
<p>Possible attributes:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">url</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mandatory field that sets url of Pact Broker.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">contractsFolder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mandatory field that sets the location of Pact files.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">username</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional field that sets the username.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">password</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional field that sets the password.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">version</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional field that sets the version of contracts in pact broker. If not set <code>latest</code> is used.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Notice that all these attributes can be set using system properties or environment variable as any other property in <code>arquillian.xml</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_git_publisher"><a class="anchor" href="#_git_publisher"></a>5.2.4. Git Publisher</h4>
<div class="paragraph">
<p>Git publisher publishes contract files to a git repository.
Optionally they can be committed into a branch or tag the commit.</p>
</div>
<div class="paragraph">
<p>This publisher just takes the generated contract files, copied to repository, commit them and push them to remote.</p>
</div>
<div class="paragraph">
<p>First of all you need to add git publisher dependency:</p>
</div>
<div class="listingblock">
<div class="title">pom.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.arquillian.algeron<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>arquillian-algeron-consumer-git-publisher<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">arquillian.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="tag">&lt;arquillian</span> <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://jboss.org/schema/arquillian</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://jboss.org/schema/arquillian</span>
    <span class="content">http://jboss.org/schema/arquillian/arquillian_1_0.xsd</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>

    <span class="tag">&lt;extension</span> <span class="attribute-name">qualifier</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">algeron-consumer</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">publishConfiguration</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            provider: git <i class="conum" data-value="1"></i><b>(1)</b>
            url: https://localhost:8080/contracts <i class="conum" data-value="2"></i><b>(2)</b>
            comment: This is a new version of contracts <i class="conum" data-value="3"></i><b>(3)</b>
            username: admin <i class="conum" data-value="4"></i><b>(4)</b>
            password: admin
            passphrase: aaaa <i class="conum" data-value="5"></i><b>(5)</b>
            key: ~/mykey <i class="conum" data-value="6"></i><b>(6)</b>
            remote: origin <i class="conum" data-value="7"></i><b>(7)</b>
            repository: /git/myrepo <i class="conum" data-value="8"></i><b>(8)</b>
            contractGitDirectory: pacts/ <i class="conum" data-value="9"></i><b>(9)</b>
            tag: v ${version:1.0.0-SNAPSHOT} <i class="conum" data-value="10"></i><b>(10)</b>
            branch: master <i class="conum" data-value="11"></i><b>(11)</b>
            email: my@email.com <i class="conum" data-value="12"></i><b>(12)</b>
            contractsFolder: target/pacts <i class="conum" data-value="13"></i><b>(13)</b>
        <span class="tag">&lt;/property&gt;</span>
    <span class="tag">&lt;/extension&gt;</span>

<span class="tag">&lt;/arquillian&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>provider</code> attribute is used for setting which publisher to use. In case of Git publisher, you need to set to <code>git</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>url</code> sets the git repository. This is mandatory field.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>comment</code> set comment message. This is mandatory field.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td><code>username</code> and <code>password</code> for accessing repository.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td><code>passphrase</code> to access to private key.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td><code>key</code> private key location, by default <code>~/.ssh/id_rsa</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td><code>remote</code> repository. By default <code>origin</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td><code>repository</code> sets location of repository. If it is an empty directory, git repository is cloned there. If it is already a git repository, a <code>git pull</code> operation is executed. By default a temp directory is created.</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td><code>pactDirectory</code> configures where pact files are stored inside repository. By default gets root directory.</td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td><code>tag</code> is used for tagging commit done with new pact files.</td>
</tr>
<tr>
<td><i class="conum" data-value="11"></i><b>11</b></td>
<td><code>branch</code> sets a branch where contract files are copied and committed. By default is <code>master</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="12"></i><b>12</b></td>
<td><code>email</code> used for commit. By default it gets email from general configuration.</td>
</tr>
<tr>
<td><i class="conum" data-value="13"></i><b>13</b></td>
<td><code>contractsFolder</code> configures folder where contract files are generated by the engine.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Any of the git attributes can be set using Java system property <code>${name:defaultvalue}</code> or environment variable <code>${env.name:defaultvalue}</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_spi"><a class="anchor" href="#_spi"></a>5.2.5. SPI</h4>
<div class="paragraph">
<p>You can also implement your own publisher.
To make it so you need create a class that implements <code>org.arquillian.algeron.consumer.spi.publisher.ContractsPublisher</code> and register this service inside <code>META-INF/services/org.arquillian.algeron.consumer.spi.publisher.ContractsPublisher</code>.</p>
</div>
<div class="paragraph">
<p>You can see an example at <a href="https://github.com/arquillian/arquillian-algeron/tree/master/consumer/git-publisher" class="bare">https://github.com/arquillian/arquillian-algeron/tree/master/consumer/git-publisher</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_jboss_forge_arquillian_addon"><a class="anchor" href="#_jboss_forge_arquillian_addon"></a>5.2.6. JBoss Forge Arquillian Addon</h4>
<div class="paragraph">
<p><a href="http://forge.jboss.org">Forge</a> Arquillian Addon offers an integration with Arquillian Algeron Publishers.</p>
</div>
<div class="paragraph">
<p>To use it apart from having the Forge Arquillian Addon installed in Forge, you also need to have Arquillian Algeron Consumer dependencies registered on build tool (for example using command <code>arquillian-algeron-setup-consumer --contracts-library pact</code> <a href="#JBoss_Forge_Arquillian_Algeron_Consumer_Addon">JBoss Forge Arquillian Consumer Addon</a> ).</p>
</div>
<div class="paragraph">
<p>Each of the publishers have its own command to be registered where you can set its specific configuration parameters.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">folder</dt>
<dd>
<p><code>arquillian-algeron-setup-publisher --publisher folder --output-folder /tmp/pacts</code></p>
</dd>
<dt class="hdlist1">url</dt>
<dd>
<p><code>arquillian-algeron-setup-publisher --publisher url --url <a href="http://localhost" class="bare">http://localhost</a></code></p>
</dd>
<dt class="hdlist1">git</dt>
<dd>
<p><code>arquillian-algeron-setup-publisher --publisher git --url <a href="http://localhost" class="bare">http://localhost</a> --comment newcomment</code></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>See it alive in next terminal cast:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="https://asciinema.org/a/104386"><img src="https://asciinema.org/a/104386.png" alt="104386"></a>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_arquillian_algeron_provider"><a class="anchor" href="#_arquillian_algeron_provider"></a>6. Arquillian Algeron Provider</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_retrievers"><a class="anchor" href="#_retrievers"></a>6.1. Retrievers</h3>
<div class="sect3">
<h4 id="_retrievers_as_annotation"><a class="anchor" href="#_retrievers_as_annotation"></a>6.1.1. Retrievers as Annotation</h4>
<div class="paragraph">
<p>One real important thing in provider tests is where contract files are located and how the test should load it.
To specify this, Arquillian Provider provides some class annotations, but of course you can implement your own as well:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">From URL</dt>
<dd>
<p><code>@ContractsUrl(urls = {"http://build.server/zoo_app-animal_service.json"} )</code></p>
</dd>
<dt class="hdlist1">From PactBroker</dt>
<dd>
<p><code>@PactBroker(url="${pactbroker.hostname:localhost}")</code>
Notice that in this case system properties with defaults are supported. Also you need to add <code>org.arquillian.algeron:arquillian-algeron-pact-provider-pact-broker-loader:${version}</code> dependency. This is only supported in case of using Pact provider.</p>
</dd>
<dt class="hdlist1">From Folder</dt>
<dd>
<p><code>@ContractsFolder("subfolder/in/resource/directory")</code>
You can use absolute or relative path. The loader first checks if resource is in classpath and if not checks directory. As with <strong>PactBroker</strong>, you can use system properties.</p>
</dd>
<dt class="hdlist1">From Maven</dt>
<dd>
<p><code>@ContractsMavenDependency(value = "org.superbiz:contract:[1.0,]")</code>. Also you need to add <code>org.arquillian.algeron:arquillian-algeron-provider-maven-retriever:${version}</code> dependency.
In case of specifying a range of versions, this loader will take always the highest one.
You can use system properties to set values too.</p>
</dd>
<dt class="hdlist1">From Git</dt>
<dd>
<p><code>@ContractsGit("https://github.com/lordofthejars/starwarspact.git")</code> Also you need to add <code>org.arquillian.algeron:arquillian-algeron-provider-git-retriever:${version}</code> dependency.
You can use system properties to set vales too. Inspect <code>@ContractsGit</code> annotation for all options that accept this loader such as authentication, use branch or tag or set a pact directory.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>It&#8217;s possible to use a custom Contracts retriever.
For this, implement interface <code>ContractsRetriever</code> and annotate the test class with <code>@ContractSource(MyOwnRetriever.class)</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
class <code>MyOwnRetriever</code> must have a default empty constructor or a constructor with one argument of class Class which at runtime will be the test class so you can get custom annotations of test class.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can see an example at: <a href="https://github.com/arquillian/arquillian-algeron/blob/master/provider/core/src/main/java/org/arquillian/algeron/provider/core/retriever/ContractsUrlLoader.java">ContractsUrlLoader</a> java class.</p>
</div>
</div>
<div class="sect3">
<h4 id="_retrievers_as_configuration"><a class="anchor" href="#_retrievers_as_configuration"></a>6.1.2. Retrievers as Configuration</h4>
<div class="paragraph">
<p>As it happens with consumer part, Arquillian Algeron allows you to configure retrievers in <code>arquillian.xml</code>.</p>
</div>
<div class="sect4">
<h5 id="_folder_retriever"><a class="anchor" href="#_folder_retriever"></a>Folder Retriever</h5>
<div class="paragraph">
<p>You can retrieve contracts from folder:</p>
</div>
<div class="listingblock">
<div class="title">arquillian.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;extension</span> <span class="attribute-name">qualifier</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">algeron-provider</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">retrieverConfiguration</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
          provider: folder
          contractsFolder: <span class="tag">&lt;folder</span> <span class="attribute-name">where</span> <span class="attribute-name">contracts</span> <span class="attribute-name">are</span> <span class="attribute-name">stored</span><span class="tag">&gt;</span>
    <span class="tag">&lt;/property&gt;</span>
<span class="tag">&lt;/extension&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_url_retriever"><a class="anchor" href="#_url_retriever"></a>URL Retriever</h5>
<div class="paragraph">
<p>You can retrieve contracts from URL/s.</p>
</div>
<div class="listingblock">
<div class="title">arquillian.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;extension</span> <span class="attribute-name">qualifier</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">algeron-provider</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">retrieverConfiguration</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
          provider: url
          url: url where contract is stored <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="tag">&lt;/property&gt;</span>
<span class="tag">&lt;/extension&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>url where contracts are stored (this can be in form of string or yml list)</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_git_retriever"><a class="anchor" href="#_git_retriever"></a>Git Retriever</h5>
<div class="paragraph">
<p>You can retrieve contracts from Git repository.</p>
</div>
<div class="listingblock">
<div class="title">arquillian.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;extension</span> <span class="attribute-name">qualifier</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">algeron-provider</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">retrieverConfiguration</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
          provider: git
          url: <span class="tag">&lt;giturl&gt;</span>
          username: username
          password: password
  <span class="tag">&lt;/property&gt;</span>
<span class="tag">&lt;/extension&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Also you need to add <code>org.arquillian.algeron:arquillian-algeron-provider-git-retriever:${version}</code> dependency.</p>
</div>
<div class="paragraph">
<p>Possible attributes:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">url</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mandatory field that sets git server url.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">username</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional field that sets the username to access to git repository.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">password</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional field that sets the password to access to git repository.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">passphrase</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional field that sets the passphrase to open the private key.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">remote</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional field that sets the remote name (algeron uses origin by default)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">key</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional field that sets the private key location. (Algeron uses ~/.ssh/id_rsa by default)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">repository</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional field that sets local location of git repository.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">contractGitRepository</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional field that sets inner folder where contracts are stored.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tag</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional field that checkouts given tag</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">branch</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional field that checkouts given branch</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Notice that all these attributes can be set using system properties or environment variable as any other property in <code>arquillian.xml</code> such as:</p>
</div>
<div class="listingblock">
<div class="title">arquillian.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;extension</span> <span class="attribute-name">qualifier</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">algeron-provider</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">retrieverConfiguration</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
          provider: git
          url: <span class="tag">&lt;giturl&gt;</span>
          username: username
          password: ${env.username}
  <span class="tag">&lt;/property&gt;</span>
<span class="tag">&lt;/extension&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_maven_retriever"><a class="anchor" href="#_maven_retriever"></a>Maven Retriever</h5>
<div class="paragraph">
<p>You can retrieve contracts from Maven artifacts.</p>
</div>
<div class="listingblock">
<div class="title">arquillian.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;extension</span> <span class="attribute-name">qualifier</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">algeron-provider</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">retrieverConfiguration</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
          provider: maven
          coordinates: <span class="tag">&lt;coordinates</span> <span class="attribute-name">of</span> <span class="attribute-name">artifact</span><span class="tag">&gt;</span>
  <span class="tag">&lt;/property&gt;</span>
<span class="tag">&lt;/extension&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Also you need to add <code>org.arquillian.algeron:arquillian-algeron-provider-maven-retriever:${version}</code> dependency.</p>
</div>
<div class="paragraph">
<p>Possible attributes:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">coordinates</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mandatory Maven coordinates of contracts. G:A:V format.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">offline</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional flag that sets Maven to work offline.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">customSettings</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional field that sets the location of custom settings.xml file.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">remoteRepository</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional field that sets URL of remote Maven repository</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Notice that all these attributes can be set using system properties or environment variable as any other property in <code>arquillian.xml</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_pact_broker_retriever"><a class="anchor" href="#_pact_broker_retriever"></a>Pact Broker Retriever</h5>
<div class="paragraph">
<p>You can retrieve contracts from Pact Broker artifacts.</p>
</div>
<div class="listingblock">
<div class="title">arquillian.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;extension</span> <span class="attribute-name">qualifier</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">algeron-provider</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">retrieverConfiguration</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
          provider: pactbroker
          url: <span class="tag">&lt;url</span> <span class="attribute-name">of</span> <span class="attribute-name">pact</span> <span class="attribute-name">broker</span> <span class="attribute-name">server</span><span class="tag">&gt;</span>
          username: <span class="tag">&lt;username</span> <span class="attribute-name">of</span> <span class="attribute-name">pact</span> <span class="attribute-name">borker</span><span class="tag">&gt;</span>
          password: <span class="tag">&lt;password</span> <span class="attribute-name">of</span> <span class="attribute-name">pact</span> <span class="attribute-name">broker</span><span class="tag">&gt;</span>
          tags: <span class="tag">&lt;tag</span> <span class="attribute-name">or</span> <span class="attribute-name">list</span> <span class="attribute-name">of</span> <span class="attribute-name">tags</span>
  <span class="error">&lt;</span><span class="error">/</span><span class="attribute-name">property</span><span class="tag">&gt;</span>
<span class="tag">&lt;/extension&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Also you need to add <code>org.arquillian.algeron:arquillian-algeron-pact-provider-pact-broker-loader:${version}</code> dependency. This is only supported in case of using Pact provider.</p>
</div>
<div class="paragraph">
<p>Possible attributes:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">url</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mandatory field that sets url of Pact Broker.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">username</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional field that sets the username of Pact Broker.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">password</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional field that sets the password of Pact Broker.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tags</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional field that sets the tags to retrieve from Pact Broker or latest by default.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Notice that all these attributes can be set using system properties or environment variable as any other property in <code>arquillian.xml</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_jboss_forge_arquillian_addon_2"><a class="anchor" href="#_jboss_forge_arquillian_addon_2"></a>6.1.3. JBoss Forge Arquillian Addon</h4>
<div class="paragraph">
<p><a href="http://forge.jboss.org">Forge</a> Arquillian Addon offers an integration with Arquillian Algeron Retrievers.</p>
</div>
<div class="paragraph">
<p>To use it apart from having the Forge Arquillian Addon installed in Forge, you also need to have Arquillian Algeron Provider dependencies registered on build tool (for example using command <code>arquillian-algeron-setup-provider --contracts-library pact</code> <a href="#JBoss_Forge_Arquillian_Algeron_Provider_Addon">JBoss Forge Arquillian Provider Addon</a> ).</p>
</div>
<div class="paragraph">
<p>Each of the publishers have its own command to be registered where you can set its specific configuration parameters.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">folder</dt>
<dd>
<p><code>arquillian-algeron-setup-retriever --retriever folder --contract-folder /tmp</code></p>
</dd>
<dt class="hdlist1">url</dt>
<dd>
<p><code>arquillian-algeron-setup-retriever --retriever url --url <a href="http://localhost" class="bare">http://localhost</a></code></p>
</dd>
<dt class="hdlist1">git</dt>
<dd>
<p><code>arquillian-algeron-setup-retriever --retriever git --url <a href="http://localhost:3000" class="bare">http://localhost:3000</a></code></p>
</dd>
<dt class="hdlist1">maven</dt>
<dd>
<p><code>arquillian-algeron-setup-retriever --retriever maven --maven-coordinates org.superbiz:foo:1.0.0</code></p>
</dd>
<dt class="hdlist1">pactbroker</dt>
<dd>
<p><code>arquillian-algeron-setup-retriever --retriever pactbroker --host <a href="http://localhost" class="bare">http://localhost</a> --port 8081</code></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>See it alive in next terminal cast:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="https://asciinema.org/a/104390"><img src="https://asciinema.org/a/104390.png" alt="104390"></a>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_arquillian_algeron_pact_provider"><a class="anchor" href="#_arquillian_algeron_pact_provider"></a>6.2. Arquillian Algeron Pact Provider</h3>
<div class="paragraph">
<p>The next thing you need to do is sent the contract (aka "pact" file) to <strong>Provider</strong> project and validate that provider produces the expected responses to defined requests.
This is done by replaying all requests defined in contract against real provider and validating that the response is the expected one.</p>
</div>
<div class="sect3">
<h4 id="_pact_provider_in_container"><a class="anchor" href="#_pact_provider_in_container"></a>6.2.1. Pact Provider In Container</h4>
<div class="paragraph">
<p>Again you can write provider&#8217;s part using in container or standalone mode.
In this section, an in container mode example is developed.</p>
</div>
<div class="paragraph">
<p>Apart from adding Arquillian bom dependencies as mentioned in <a href="#arqdeps">consumer part</a>, you need to add arquillian algeron pact dependencies:</p>
</div>
<div class="listingblock">
<div class="title">pom.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.arquillian.algeron<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>arquillian-algeron-pact-provider-core<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;scope&gt;</span>test<span class="tag">&lt;/scope&gt;</span>
    <span class="tag">&lt;version&gt;</span>${version.arquillian_algeron}<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span>
<span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>au.com.dius<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>pact-jvm-provider_2.11<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;scope&gt;</span>test<span class="tag">&lt;/scope&gt;</span>
    <span class="tag">&lt;version&gt;</span>3.5.0-beta.2<span class="tag">&lt;/version&gt;</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Arquillian Algeron Pact has been tested with latest version, but it should work with any 3.X version.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After dependencies you can write the test that replies all contracts against provider:</p>
</div>
<div id="provincon" class="listingblock">
<div class="title">MyServiceProviderTest.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@RunWith</span>(Arquillian.class)
<span class="annotation">@Provider</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">test_provider</span><span class="delimiter">&quot;</span></span>) <i class="conum" data-value="1"></i><b>(1)</b>
<span class="annotation">@PactFolder</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">pacts</span><span class="delimiter">&quot;</span></span>) <i class="conum" data-value="2"></i><b>(2)</b>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyServiceProviderTest</span> {

    <span class="annotation">@Deployment</span>(testable = <span class="predefined-constant">false</span>) <i class="conum" data-value="3"></i><b>(3)</b>
    <span class="directive">public</span> <span class="directive">static</span> WebArchive createDeployment() {
        <span class="keyword">return</span> ShrinkWrap.create(WebArchive.class).addClass(MyService.class);
    }

    <span class="annotation">@ArquillianResource</span> <i class="conum" data-value="4"></i><b>(4)</b>
    <span class="predefined-type">URL</span> webapp;

    <span class="annotation">@ArquillianResource</span> <i class="conum" data-value="5"></i><b>(5)</b>
    <span class="predefined-type">Target</span> target;

    <span class="annotation">@Test</span>
    <span class="directive">public</span> <span class="type">void</span> should_provide_valid_answers() {
        target.testInteraction(webapp); <i class="conum" data-value="6"></i><b>(6)</b>
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Sets the name of provider used in this test</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Configures where to get pact files</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Deploys provider application to app server</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Arquillian injection of URL where application is deployed</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>A target is a class that makes all requests to provider. In case of Arquillian Algeron Pact by default it uses an Http Client target</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Makes the request to provider and validates that the response is the expected one</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When running this test Arquillian Algeron Pact Provider will do next things:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Deploy provider to chosen application server, as any other Arquillian test.</p>
</li>
<li>
<p>Read all contract files present in classpath folder <code>pacts</code> which the provider is <code>test_provider</code>. Of course there can be more than one since a provider might serve several consumers.</p>
</li>
<li>
<p>For each contract, it will extract each of the request/response pair</p>
</li>
<li>
<p>For each request/response it sends the request specified in contract to provider and validate the response against expectations defined in contract.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>So as you can see the <code>should_provide_valid_answers</code> might be run several times depending on the number of consumers that depends on provider and the number of requests/responses defined.
But this is something that it is managed automatically by Arquillian Algeron Pact.</p>
</div>
<div class="paragraph">
<p>You can see full example at: <a href="https://github.com/arquillian/arquillian-algeron/tree/master/pact/provider/ftest-container">ftest-incontainer</a></p>
</div>
</div>
<div class="sect3">
<h4 id="_pact_provider_standalone"><a class="anchor" href="#_pact_provider_standalone"></a>6.2.2. Pact Provider Standalone</h4>
<div class="paragraph">
<p>The only difference between previous example is that you only need <code>arquillian-junit-standalone</code> instead of <code>arquilian-junit-container</code> and don&#8217;t need to define any container adapter.
Obviously no <code>@Deployment</code> method is required:</p>
</div>
<div class="listingblock">
<div class="title">StarWarsProviderTest</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@RunWith</span>(Arquillian.class)
<span class="annotation">@Provider</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">planets_provider</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@PactFolder</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">pacts</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">StarWarsProviderTest</span> {

    <span class="annotation">@ClassRule</span> <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> ClientDriverRule embeddedService = <span class="keyword">new</span> ClientDriverRule(<span class="integer">8332</span>);

    <span class="annotation">@ArquillianResource</span>
    <span class="predefined-type">Target</span> target;

    <span class="annotation">@BeforeClass</span> <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> recordServerInteractions() {
        embeddedService.addExpectation(
                onRequestTo(<span class="string"><span class="delimiter">&quot;</span><span class="content">/rest/planet/orbital/average</span><span class="delimiter">&quot;</span></span>)
                    .withMethod(ClientDriverRequest.Method.GET),
                giveResponse(<span class="string"><span class="delimiter">&quot;</span><span class="content">1298.3</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>).withStatus(<span class="integer">200</span>));

        embeddedService.addExpectation(
                onRequestTo(<span class="string"><span class="delimiter">&quot;</span><span class="content">/rest/planet/orbital/biggest</span><span class="delimiter">&quot;</span></span>)
                        .withMethod(ClientDriverRequest.Method.GET),
                giveResponseAsBytes(StarWarsProviderTest.class.getResourceAsStream(<span class="string"><span class="delimiter">&quot;</span><span class="content">/server.json</span><span class="delimiter">&quot;</span></span>), <span class="string"><span class="delimiter">&quot;</span><span class="content">application/json</span><span class="delimiter">&quot;</span></span>).withStatus(<span class="integer">200</span>));

    }


    <span class="annotation">@Test</span>
    <span class="directive">public</span> <span class="type">void</span> validateProvider() {
        target.testInteraction();
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Stub server to not having to having to deploy an application</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Expectations/Implementation of provider server</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can see full example at: <a href="https://github.com/arquillian/arquillian-algeron/tree/master/pact/provider/ftest">ftest</a></p>
</div>
</div>
<div class="sect3">
<h4 id="_pact_provider_enrichers"><a class="anchor" href="#_pact_provider_enrichers"></a>6.2.3. Pact Provider Enrichers</h4>
<div class="paragraph">
<p>You can enrich your test with current consumer and current request/response interaction by using <code>@CurrentConsumer</code> and <code>CurrentInteraction</code> annotations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@CurrentConsumer</span>
Consumer consumer;

<span class="annotation">@CurrentInteraction</span>
RequestResponseInteraction interaction;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_pact_provider_configuration"><a class="anchor" href="#_pact_provider_configuration"></a>6.2.4. Pact Provider Configuration</h4>
<div class="paragraph">
<p>Arquillian Algeron Pact Provider can be configured using Arquillian configuration mechanism (<code>arquillian.xml</code> file or system properties).</p>
</div>
<div class="listingblock">
<div class="title">arquillian.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="tag">&lt;arquillian</span> <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://jboss.org/schema/arquillian</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://jboss.org/schema/arquillian</span>
    <span class="content">http://jboss.org/schema/arquillian/arquillian_1_0.xsd</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>

    <span class="tag">&lt;extension</span> <span class="attribute-name">qualifier</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">pact-provider</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">port</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>8332<span class="tag">&lt;/property&gt;</span>
    <span class="tag">&lt;/extension&gt;</span>

<span class="tag">&lt;/arquillian&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The attributes are:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">targetUrl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Url to used by <code>target</code> to connect to provider</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">insecure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">In case of https if test should skip https validations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">protocol</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">protocol used to connect in case of not using <code>targetUrl</code> property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">http</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">host used to connect in case of not using <code>targetUrl</code> property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">localhost</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">port used to connect in case of not using <code>targetUrl</code> property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8080</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">path appended at the end of the host in case of not using <code>targetUrl</code> property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Notice that in case of using incontainer tests you don&#8217;t need to configure any of these parameters (except if <em>insecure</em> is required) since you can use the URL injected by Arquillian.
See this at <a href="#provincon">provider in container</a> example.</p>
</div>
</div>
<div class="sect3">
<h4 id="_pact_states"><a class="anchor" href="#_pact_states"></a>6.2.5. Pact States</h4>
<div class="paragraph">
<p>Each interaction in a pact should be verified in isolation, with no context maintained from the previous interactions.
Provider states allow you to set up data on the provider by injecting it straight into the datasource before the interaction is run, so that it can make a response that matches what the consumer expects.</p>
</div>
<div class="paragraph">
<p>Provider states also allow the consumer to make the same request with different expected responses.</p>
</div>
<div class="paragraph">
<p>Provider state is all about the state of the provider, not about the state of the consumer, or about what is in the request.</p>
</div>
<div class="paragraph">
<p>In consumer side you set an state using <code>given</code> section.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="paragraph">
<p><code>builder.given("test state")&#8230;&#8203;</code> sets state as plain String.</p>
</div>
<div class="paragraph">
<p>Or in case you want to set some parameters you can do:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Map</span> parameters = <span class="keyword">new</span> <span class="predefined-type">HashMap</span>&lt;&gt;();
builder.given(<span class="string"><span class="delimiter">&quot;</span><span class="content">test state</span><span class="delimiter">&quot;</span></span>, parameters)...</code></pre>
</div>
</div>
<div class="paragraph">
<p>which in this case sets an state name with some key/value pairs.</p>
</div>
<div class="paragraph">
<p>But in <strong>Arquillian Algeron Pact Provider</strong> we also give support for states in the form of <em>Cucumber</em> expression.
You can define an state with the form:</p>
</div>
<div class="paragraph">
<p><code>builder.given("I have 36 cukes in my belly")&#8230;&#8203;</code></p>
</div>
<div class="paragraph">
<p>So the next question is how can I respond to states in provider side?
Let&#8217;s see an example in each case:</p>
</div>
<div class="paragraph">
<p>In first example you only set a state with a name, without any parameter, so in your provider side you are going to do:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@State</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">test state</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">void</span> testStateMethod(<span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; params) {
    <span class="comment">// Do some data preparation</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This method is executed if and only if given interaction has defined the state <code>test state</code>.</p>
</div>
<div class="paragraph">
<p>Obviously in previous example you have no way to pass parameters from consumer to provider.
In second example you are passing a map with some parameters.
To recover them you need to add as method parameter a <code>Map</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@State</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">test state</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">void</span> testStateMethod(<span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; params) {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This method is executed if and only if given interaction has defined the state <code>test state</code> and injects the defined parameters in consumer as method parameter.</p>
</div>
<div class="paragraph">
<p>Also the third case uses Cucumber-lik expression, so you need similar way to take parameters.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@State</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">I have (</span><span class="char">\\</span><span class="content">d+) cukes in my belly</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">void</span> stateMethod(<span class="type">int</span> numberOfCukes) {
    <span class="local-variable">this</span>.numberOfCukes = numberOfCukes;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice that now as happens with Cucumber you need to specify the regular expression and you get the values as method parameters.
Native values and list are supported.
Lists are set in consumer side as comma-separated values and scanned as <code>\\s+</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_assertj_integration"><a class="anchor" href="#_assertj_integration"></a>6.2.6. AssertJ integration</h4>
<div class="paragraph">
<p>Arquillian Algeron Pact Provider implements custom matcher of AssertJ for validating contracts against provider.</p>
</div>
<div class="paragraph">
<p>First thing to do to use AssertJ matcher is add <code>arquillian-algeron-pact-provider-assertj</code> dependency, and the <strong>AssertJ</strong> you want to use.</p>
</div>
<div class="listingblock">
<div class="title">pom.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.arquillian.algeron<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>arquillian-algeron-pact-provider-assertj<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;scope&gt;</span>test<span class="tag">&lt;/scope&gt;</span>
<span class="tag">&lt;/dependency&gt;</span>
<span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.assertj<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>assertj-core<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;scope&gt;</span>test<span class="tag">&lt;/scope&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally in your test you can use the overloaded <code>assertThat</code> static method receiving a <code>Target</code> type.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ArquillianResource</span>
<span class="predefined-type">URL</span> webapp;

<span class="annotation">@ArquillianResource</span>
<span class="predefined-type">Target</span> target;

<span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> should_provide_valid_answers() {
    assertThat(target).withUrl(webapp).satisfiesContract();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice that now instead of writing <code>target.testInteraction(webapp);</code> you are using a more readable way of asserting test.</p>
</div>
</div>
<div class="sect3">
<h4 id="_arquillian_recorder_reporter_integration"><a class="anchor" href="#_arquillian_recorder_reporter_integration"></a>6.2.7. Arquillian Recorder Reporter integration</h4>
<div class="paragraph">
<p>Currently pact generates report from contract tests in several formats, including Markdown or JSON.
You can also report using Arquillian Recorder Reporter (<a href="https://github.com/arquillian/arquillian-recorder" class="bare">https://github.com/arquillian/arquillian-recorder</a>) extension.</p>
</div>
<div class="paragraph">
<p>To use it you need to annotate at test class level with <code>VerificationReports</code> and set type to <code>recorder</code> and add Arquillian Recorder Reporter dependency <code>org.arquillian.extension:arquillian-recorder-reporter-impl:&lt;version&gt;</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
you can set more than reporter at once so you can do <code>@VerificationReports(value = {"console", "recorder"})</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="JBoss_Forge_Arquillian_Algeron_Provider_Addon"><a class="anchor" href="#JBoss_Forge_Arquillian_Algeron_Provider_Addon"></a>6.2.8. JBoss Forge Arquillian Addon</h4>
<div class="paragraph">
<p><a href="http://forge.jboss.org">Forge</a> Arquillian Addon offers an integration with Arquillian Algeron Provider.</p>
</div>
<div class="paragraph">
<p>To use it apart from having the Forge Arquillian Addon installed in Forge, you need to have arquillian dependencies registered on build tool.</p>
</div>
<div class="paragraph">
<p>To register Arquillian Provider dependencies in build tool just run next command:</p>
</div>
<div class="paragraph">
<p><code>arquillian-algeron-setup-provider --contracts-library pact</code></p>
</div>
<div class="paragraph">
<p>After that you can enrich a given Arquillian test with provider annotations:</p>
</div>
<div class="paragraph">
<p><code>arquillian-algeron-create-provider-test --provider myprovider --test-class org.superbiz.MyContractTest</code></p>
</div>
<div class="paragraph">
<p>It is important to note that test class should be already created (for example using <code>arquillian-create-test --named MyContractTest --target-package org.superbiz</code> command).</p>
</div>
<div class="paragraph">
<p>See it alive in next terminal cast:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="https://asciinema.org/a/104387"><img src="https://asciinema.org/a/104387.png" alt="104387"></a>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_skipping_deployment"><a class="anchor" href="#_skipping_deployment"></a>6.3. Skipping Deployment</h3>
<div class="paragraph">
<p>In case of consumer driven contracts, there are two kinds of tests - consumer tests and provider tests.
Usually in your CI environment you want to run provider tests against two different scenarios:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">against a master branch of provider</dt>
<dd>
<p>to detect if provider team has already implemented all the functionality defined in contracts.</p>
</dd>
<dt class="hdlist1">against (pre)production</dt>
<dd>
<p>if you support deploying consumer independently of a provider, then you need to ensure that if you deploy new consumer with the new contracts to (pre)production everything will be still working and you haven&#8217;t introduced any regressions.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>So before deploying a new consumer you need to verify that from provider side everything will continue working.</p>
</div>
<div class="paragraph">
<p>In both cases, the test itself is exactly the same.
There is only one slight difference in both cases which how you set up your test environments.
In the first scenario, you want to deploy the latest provider code. One way of doing it is using Arquillian container control and <code>@Deployment</code> method to create the package, start the container and deploy it.
But in the latter case, when you want to run contract test against provider that is already deployed on (pre)production environment, you don’t need to deploy anything nor control the lifecycle of any container.
For this reason we provided <code>skipDeployment</code> flag.</p>
</div>
<div class="listingblock">
<div class="title">arquillian.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;extension</span> <span class="attribute-name">qualifier</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">algeron-provider</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">skipDeployment</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>${env.skipDeployment:false}<span class="tag">&lt;/property&gt;</span>
<span class="tag">&lt;/extension&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>skipDeployment</code> default value by default is set to <code>false, which means that the test will behave as it usually does, but when it is set to @`true, Arquillian is going to ignore anything related to container lifecycle. `
To use this strategy your test needs to be defined as `@RunAsClient</code>. You can think of it as a dynamic way of converting an Arquillian container test into Arquillian standalone test.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s see an example:</p>
</div>
<div class="listingblock">
<div class="title">MyServiceProviderTest.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@RunWith</span>(Arquillian.class)
<span class="annotation">@Provider</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">test_provider</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@PactFolder</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">pacts</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@RunAsClient</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyServiceProviderTest</span> {

    <span class="annotation">@Deployment</span>(testable = <span class="predefined-constant">false</span>)
    <span class="directive">public</span> <span class="directive">static</span> WebArchive createDeployment() {
        <span class="keyword">return</span> ShrinkWrap.create(WebArchive.class).addClass(MyService.class);
    }

    <span class="annotation">@ArquillianResource</span>
    <span class="annotation">@Environment</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">myservice.url</span><span class="delimiter">&quot;</span></span>) <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="predefined-type">URL</span> webapp;

    <span class="annotation">@ArquillianResource</span>
    <span class="predefined-type">Target</span> target;

    <span class="annotation">@Test</span>
    <span class="directive">public</span> <span class="type">void</span> should_provide_valid_answers() {
        target.testInteraction(webapp);
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Environment annotation to set URL in case of skipping deployment</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Given previous test, if <code>skipDeployment</code> is <strong>false</strong>, this test will behave like:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Start chosen application server (Wildfly, TomEE, Tomcat, &#8230;&#8203;).</p>
</li>
<li>
<p>Package and Deploy <code>MyService</code>.</p>
</li>
<li>
<p>Enrich <code>webapp</code> URL with the one provided by application server.
<code>@Environment</code> variable is ignored.</p>
</li>
<li>
<p>Executes contract test against deployed application.</p>
</li>
<li>
<p>Undeploy and stop everything.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>But if you set <code>skipDeployment</code> to <strong>true</strong>, lifecycle is slightly different:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Enrich <code>webapp</code> URL with Java system property or environment variable named <code>myservice.url</code> set in <code>@Environment</code>.</p>
</li>
<li>
<p>Executes contract tests against URL provided by <code>@Environment</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>There is no additional "behind the scenes" Arquillian magic involved.
Notice that with a simple attribute you can enable/disable how Arquillian behaves regarding the deployment lifecycle, and how you can reuse same test (DRY) for different scenarios.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you want to enable skipDeployment feature, you can set Java system property or environment variable <code>arq.extension.algeron-provider.skipDeployment</code> to true or by using <code>${env.skipDeployment:false}</code> form.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2019-08-26 13:45:30 UTC
</div>
</div>
</body>
</html>